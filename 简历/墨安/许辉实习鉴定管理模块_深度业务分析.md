# è®¸è¾‰å®ä¹ é‰´å®šç®¡ç†æ¨¡å— - æ·±åº¦ä¸šåŠ¡åˆ†æ

## ğŸ“‹ æ¨¡å—æ¦‚è§ˆ

**å¼€å‘è€…**: è®¸è¾‰ ğŸ”¥
**æ¨¡å—è·¯å¾„**: `src/views/departmentRecord/practiceAppraisal/`
**å¼€å‘æ—¶é—´**: 2024å¹´10æœˆ
**æ–‡ä»¶æ•°é‡**: 16ä¸ªVueæ–‡ä»¶
**å¤æ‚åº¦**: â­â­â­â­â­ (æé«˜å¤æ‚åº¦)

### æ¨¡å—å®šä½
å®ä¹ é‰´å®šç®¡ç†æ¨¡å—æ˜¯è®¸è¾‰åœ¨ç§‘å®¤è®°å½•ç®¡ç†ç³»ç»Ÿä¸­å¼€å‘çš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼Œè´Ÿè´£ç®¡ç†å®ä¹ ç”Ÿåœ¨å„ç§‘å®¤çš„å®ä¹ é‰´å®šå…¨æµç¨‹ï¼ŒåŒ…æ‹¬é‰´å®šè¯¦æƒ…ç®¡ç†ã€å®¡æ‰¹æµç¨‹ã€æ¨¡æ¿é…ç½®ã€å¤šç»´åº¦è¯„ä¼°ç­‰å¤æ‚ä¸šåŠ¡åŠŸèƒ½ï¼Œæ˜¯åŒ»é™¢å®ä¹ ç®¡ç†æ•°å­—åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### 1. æ ¸å¿ƒç»„ä»¶æ¶æ„

#### 1.1 ä¸»è¦ä¸šåŠ¡ç»„ä»¶
```javascript
// å®ä¹ é‰´å®šç®¡ç†æ ¸å¿ƒç»„ä»¶æ¶æ„
const practiceAppraisalArchitecture = {
  coreComponents: {
    appraisalDetail: {
      file: 'appraisalDetail.vue',
      function: 'å®ä¹ é‰´å®šè¯¦æƒ…é¡µé¢',
      complexity: 'â­â­â­â­â­',
      features: [
        'å¤šç»´åº¦è¯„ä¼°ç»„ä»¶é›†æˆ',
        'åŠ¨æ€æ ‡ç­¾é¡µç®¡ç†',
        'å®æ—¶æ•°æ®åŒæ­¥',
        'æƒé™æ§åˆ¶'
      ]
    },
    
    appraisalDetailApprove: {
      file: 'appraisalDetailApprove.vue',
      function: 'å®ä¹ é‰´å®šå®¡æ‰¹é¡µé¢',
      complexity: 'â­â­â­â­â­',
      features: [
        'å®¡æ‰¹æµç¨‹ç®¡ç†',
        'å®¡æ‰¹æ„è§å½•å…¥',
        'çŠ¶æ€æµè½¬æ§åˆ¶',
        'å®¡æ‰¹å†å²è®°å½•'
      ]
    },
    
    identificationTemplateConfig: {
      file: 'identificationTemplateConfig.vue',
      function: 'é‰´å®šæ¨¡æ¿é…ç½®',
      complexity: 'â­â­â­â­â­',
      features: [
        'åŠ¨æ€æ¨¡æ¿é…ç½®',
        'ç§‘å®¤å±æ€§ç®¡ç†',
        'æ¨¡å—ç»„åˆé…ç½®',
        'æƒé‡è®¾ç½®'
      ]
    },
    
    recordDetail: {
      file: 'recordDetail.vue',
      function: 'è®°å½•è¯¦æƒ…ç®¡ç†',
      complexity: 'â­â­â­â­',
      features: [
        'è¯¦ç»†ä¿¡æ¯å±•ç¤º',
        'ç¼–è¾‘æƒé™æ§åˆ¶',
        'æ•°æ®éªŒè¯',
        'ä¿å­˜æœºåˆ¶'
      ]
    }
  }
}
```

#### 1.2 å¤šç»´åº¦è¯„ä¼°ç»„ä»¶ä½“ç³»
```javascript
// è®¸è¾‰è®¾è®¡çš„9å¤§è¯„ä¼°ç»„ä»¶ä½“ç³»
const evaluationComponentsSystem = {
  components: {
    attendance: {
      name: 'è€ƒå‹¤ç®¡ç†ç»„ä»¶',
      file: 'components/attendance.vue',
      function: 'è€ƒå‹¤ç»Ÿè®¡å’Œåˆ†æ',
      dataSource: 'è½®è½¬æ—¶é—´+è¯·å‡è®°å½•',
      calculation: 'è‡ªåŠ¨è®¡ç®—è€ƒå‹¤ç‡'
    },
    
    electronicManual: {
      name: 'ç”µå­æ‰‹å†Œç»„ä»¶',
      file: 'components/electronicManual.vue',
      function: 'ç”µå­æ‰‹å†Œé›†æˆ',
      dataSource: 'å®ä¹ æ‰‹å†Œç³»ç»Ÿ',
      integration: 'ä¸å®ä¹ æ‰‹å†Œç³»ç»Ÿæ·±åº¦é›†æˆ'
    },
    
    evaluation: {
      name: 'è¯„ä»·ç®¡ç†ç»„ä»¶',
      file: 'components/evaluation.vue',
      function: 'å‡ºç§‘è¯„ä»·ç®¡ç†',
      dataSource: 'è¯„ä»·ç³»ç»Ÿæ•°æ®',
      features: ['å¤šç»´åº¦è¯„ä»·', 'è¯„åˆ†ç»Ÿè®¡', 'è¯„ä»·åˆ†æ']
    },
    
    assessment: {
      name: 'è€ƒæ ¸è¯„ä¼°ç»„ä»¶',
      file: 'components/assessment.vue',
      function: 'å‡ºç§‘è€ƒæ ¸è¯„åˆ†',
      dataSource: 'è€ƒæ ¸ç³»ç»Ÿæ•°æ®',
      features: ['æŠ€èƒ½è€ƒæ ¸', 'ç†è®ºè€ƒè¯•', 'ç»¼åˆè¯„ä¼°']
    },
    
    diseaseOperation: {
      name: 'ç—…ä¾‹æ‰‹æœ¯ç»„ä»¶',
      file: 'components/diseaseOperation.vue',
      function: 'ç—…ä¾‹æ‰‹æœ¯è®°å½•',
      dataSource: 'ä¸´åºŠå®è·µè®°å½•',
      features: ['ç—…ä¾‹åˆ†æ', 'æ‰‹æœ¯è®°å½•', 'æŠ€èƒ½è¯„ä¼°']
    },
    
    statistical: {
      name: 'ç»Ÿè®¡åˆ†æç»„ä»¶',
      file: 'components/statistical.vue',
      function: 'å®ä¹ ç™»è®°è¡¨ç»Ÿè®¡',
      dataSource: 'å®ä¹ æ•°æ®æ±‡æ€»',
      features: ['æ•°æ®ç»Ÿè®¡', 'å›¾è¡¨å±•ç¤º', 'è¶‹åŠ¿åˆ†æ']
    },
    
    summaryText: {
      name: 'æ€»ç»“æ–‡æœ¬ç»„ä»¶',
      file: 'components/summaryText.vue',
      function: 'å®ä¹ å°ç»“ç®¡ç†',
      dataSource: 'å­¦å‘˜è‡ªä¸»å¡«å†™',
      features: ['æ–‡æœ¬ç¼–è¾‘', 'æ ¼å¼æ§åˆ¶', 'å†…å®¹å®¡æ ¸']
    },
    
    others: {
      name: 'å…¶ä»–è®°å½•ç»„ä»¶',
      file: 'components/others.vue',
      function: 'å…¶ä»–äº‹æ•…è®°å½•',
      dataSource: 'ç‰¹æ®Šäº‹ä»¶è®°å½•',
      features: ['äº‹æ•…è®°å½•', 'å¼‚å¸¸æƒ…å†µ', 'å¤„ç†æªæ–½']
    },
    
    teachActive: {
      name: 'æ•™å­¦æ´»åŠ¨ç»„ä»¶',
      file: 'components/teachActive.vue',
      function: 'æ•™å­¦æ´»åŠ¨è®°å½•',
      dataSource: 'æ•™å­¦æ´»åŠ¨ç³»ç»Ÿ',
      features: ['æ´»åŠ¨å‚ä¸', 'å­¦ä¹ è®°å½•', 'æ•ˆæœè¯„ä¼°']
    }
  }
}
```

### 2. ä¸šåŠ¡æµç¨‹è®¾è®¡

#### 2.1 å®ä¹ é‰´å®šå®Œæ•´æµç¨‹
```mermaid
graph TB
    A[å®ä¹ é‰´å®šå¯åŠ¨] --> B[æ¨¡æ¿é…ç½®æ£€æŸ¥]
    B --> C[æ•°æ®è‡ªåŠ¨é‡‡é›†]
    C --> D[å¤šç»´åº¦è¯„ä¼°]
    D --> E[ç»¼åˆè¯„åˆ†è®¡ç®—]
    E --> F[é‰´å®šæŠ¥å‘Šç”Ÿæˆ]
    F --> G[æäº¤å®¡æ‰¹]
    G --> H[å¤šçº§å®¡æ‰¹æµç¨‹]
    H --> I{å®¡æ‰¹ç»“æœ}
    I -->|é€šè¿‡| J[é‰´å®šå®Œæˆ]
    I -->|é€€å›| K[ä¿®æ”¹å®Œå–„]
    K --> D
    J --> L[æ•°æ®å½’æ¡£]
    
    subgraph "æ•°æ®é‡‡é›†é˜¶æ®µ"
        C --> C1[è€ƒå‹¤æ•°æ®]
        C --> C2[æ•™å­¦æ´»åŠ¨æ•°æ®]
        C --> C3[è€ƒæ ¸è¯„ä»·æ•°æ®]
        C --> C4[å®ä¹ æ‰‹å†Œæ•°æ®]
    end
    
    subgraph "è¯„ä¼°è®¡ç®—é˜¶æ®µ"
        D --> D1[è€ƒå‹¤è¯„ä¼°]
        D --> D2[å­¦ä¹ è¯„ä¼°]
        D --> D3[æŠ€èƒ½è¯„ä¼°]
        D --> D4[æ€åº¦è¯„ä¼°]
    end
    
    subgraph "å®¡æ‰¹æµç¨‹é˜¶æ®µ"
        H --> H1[ç§‘å®¤åˆå®¡]
        H --> H2[æ•™åŠ¡å¤å®¡]
        H --> H3[ä¸»ç®¡ç»ˆå®¡]
    end
```

#### 2.2 æ¨¡æ¿é…ç½®æµç¨‹
```javascript
// æ¨¡æ¿é…ç½®ä¸šåŠ¡é€»è¾‘
class TemplateConfigurationEngine {
  constructor() {
    this.moduleTypes = {
      TEACHING_ACTIVTIES: 'æ•™å­¦æ´»åŠ¨',
      EXAM_STATISTICS: 'è€ƒå‹¤ç»Ÿè®¡',
      MANUAL: 'ç”µå­æ‰‹å†Œ',
      GRADUATION_EXAMINE: 'å‡ºç§‘è€ƒæ ¸',
      GRADUATION_EVALUATE: 'å‡ºç§‘è¯„ä»·',
      GRADUATION_SUMMARY: 'å®ä¹ å°ç»“',
      OTHER: 'å…¶ä»–è®°å½•',
      PRA_STATISTICAL: 'å®ä¹ ç™»è®°è¡¨'
    }
    
    this.autoDataModules = [
      'TEACHING_ACTIVTIES',  // è‡ªåŠ¨è·å–æ•™å­¦æ´»åŠ¨æ•°æ®
      'GRADUATION_EXAMINE',  // è‡ªåŠ¨è·å–å‡ºç§‘è€ƒæ ¸æ•°æ®
      'GRADUATION_EVALUATE', // è‡ªåŠ¨è·å–å‡ºç§‘è¯„ä»·æ•°æ®
      'EXAM_STATISTICS'      // è‡ªåŠ¨è®¡ç®—è€ƒå‹¤æ•°æ®
    ]
    
    this.manualDataModules = [
      'GRADUATION_SUMMARY',  // éœ€è¦å®ä¹ ç”Ÿæ‰‹åŠ¨å¡«å†™
      'OTHER',              // éœ€è¦æ‰‹åŠ¨è®°å½•
      'MANUAL'              // éœ€è¦æ‰‹åŠ¨å¡«å†™å®ä¹ ç™»è®°è¡¨
    ]
  }
  
  // é…ç½®æ¨¡æ¿ç»„æˆ
  configureTemplate(departmentAttribute, moduleSelection) {
    const template = {
      deptAttributeName: departmentAttribute,
      graduateModuleList: []
    }
    
    for (const moduleCode of moduleSelection) {
      const module = {
        moduleCode: moduleCode,
        moduleName: this.moduleTypes[moduleCode],
        isRequired: this.isRequiredModule(moduleCode),
        dataSource: this.getDataSource(moduleCode),
        weight: this.calculateModuleWeight(moduleCode),
        autoCalculate: this.autoDataModules.includes(moduleCode)
      }
      
      template.graduateModuleList.push(module)
    }
    
    return template
  }
  
  // éªŒè¯æ¨¡æ¿é…ç½®
  validateTemplate(template) {
    const validation = {
      isValid: true,
      errors: [],
      warnings: []
    }
    
    // æ£€æŸ¥å¿…éœ€æ¨¡å—
    const requiredModules = ['EXAM_STATISTICS', 'GRADUATION_EXAMINE']
    for (const required of requiredModules) {
      if (!template.graduateModuleList.some(m => m.moduleCode === required)) {
        validation.errors.push(`ç¼ºå°‘å¿…éœ€æ¨¡å—: ${this.moduleTypes[required]}`)
        validation.isValid = false
      }
    }
    
    // æ£€æŸ¥æƒé‡æ€»å’Œ
    const totalWeight = template.graduateModuleList.reduce((sum, m) => sum + m.weight, 0)
    if (Math.abs(totalWeight - 100) > 0.01) {
      validation.warnings.push(`æ¨¡å—æƒé‡æ€»å’Œä¸º${totalWeight}%ï¼Œå»ºè®®è°ƒæ•´ä¸º100%`)
    }
    
    return validation
  }
}
```

---

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯åˆ›æ–°

### 1. åŠ¨æ€ç»„ä»¶åŠ è½½ç³»ç»Ÿ

#### 1.1 æ™ºèƒ½ç»„ä»¶æ˜ å°„
```javascript
// è®¸è¾‰è®¾è®¡çš„åŠ¨æ€ç»„ä»¶åŠ è½½æœºåˆ¶
const dynamicComponentLoader = {
  componentMapping: {
    TEACHING_ACTIVTIES: 'teachActive',    // æ•™å­¦æ´»åŠ¨
    EXAM_STATISTICS: 'attendance',        // è€ƒå‹¤ç»Ÿè®¡
    MANUAL: 'electronicManual',          // ç”µå­æ‰‹å†Œ
    GRADUATION_EXAMINE: 'assessment',     // å‡ºç§‘è€ƒæ ¸
    GRADUATION_EVALUATE: 'evaluation',   // å‡ºç§‘è¯„ä»·
    GRADUATION_SUMMARY: 'summaryText',   // å®ä¹ å°ç»“
    OTHER: 'others',                     // å…¶ä»–è®°å½•
    PRA_STATISTICAL: 'statistical'      // å®ä¹ ç™»è®°è¡¨
  },
  
  // åŠ¨æ€åŠ è½½ç»„ä»¶
  loadComponent(moduleCode, props) {
    const componentName = this.componentMapping[moduleCode]
    
    if (!componentName) {
      console.warn(`æœªæ‰¾åˆ°æ¨¡å— ${moduleCode} å¯¹åº”çš„ç»„ä»¶`)
      return null
    }
    
    return {
      component: componentName,
      props: {
        ...props,
        moduleCode: moduleCode,
        readonly: props.readonly || false,
        formId: props.formId
      }
    }
  },
  
  // ç»„ä»¶çŠ¶æ€ç®¡ç†
  manageComponentState(components) {
    const state = {
      loadedComponents: new Map(),
      componentData: new Map(),
      validationResults: new Map()
    }
    
    for (const component of components) {
      state.loadedComponents.set(component.moduleCode, component)
      state.componentData.set(component.moduleCode, component.data || {})
      state.validationResults.set(component.moduleCode, { valid: true, errors: [] })
    }
    
    return state
  }
}
```

#### 1.2 ç»„ä»¶é€šä¿¡æœºåˆ¶
```javascript
// ç»„ä»¶é—´é€šä¿¡å’Œæ•°æ®åŒæ­¥
class ComponentCommunicationHub {
  constructor() {
    this.eventBus = new Vue()
    this.componentRegistry = new Map()
    this.dataStore = new Map()
  }
  
  // æ³¨å†Œç»„ä»¶
  registerComponent(componentId, component) {
    this.componentRegistry.set(componentId, component)
    
    // ç›‘å¬ç»„ä»¶æ•°æ®å˜åŒ–
    component.$watch('data', (newData) => {
      this.onComponentDataChange(componentId, newData)
    }, { deep: true })
  }
  
  // ç»„ä»¶æ•°æ®å˜åŒ–å¤„ç†
  onComponentDataChange(componentId, newData) {
    this.dataStore.set(componentId, newData)
    
    // å¹¿æ’­æ•°æ®å˜åŒ–äº‹ä»¶
    this.eventBus.$emit('component-data-changed', {
      componentId: componentId,
      data: newData,
      timestamp: new Date()
    })
    
    // è§¦å‘ç›¸å…³ç»„ä»¶æ›´æ–°
    this.triggerRelatedComponentsUpdate(componentId, newData)
  }
  
  // è§¦å‘ç›¸å…³ç»„ä»¶æ›´æ–°
  triggerRelatedComponentsUpdate(sourceComponentId, data) {
    const dependencies = this.getComponentDependencies(sourceComponentId)
    
    for (const dependentId of dependencies) {
      const component = this.componentRegistry.get(dependentId)
      if (component && component.onRelatedDataChange) {
        component.onRelatedDataChange(sourceComponentId, data)
      }
    }
  }
  
  // è·å–ç»„ä»¶ä¾èµ–å…³ç³»
  getComponentDependencies(componentId) {
    const dependencies = {
      'attendance': ['statistical'],           // è€ƒå‹¤å½±å“ç»Ÿè®¡
      'assessment': ['evaluation', 'statistical'], // è€ƒæ ¸å½±å“è¯„ä»·å’Œç»Ÿè®¡
      'evaluation': ['statistical'],          // è¯„ä»·å½±å“ç»Ÿè®¡
      'teachActive': ['statistical']          // æ•™å­¦æ´»åŠ¨å½±å“ç»Ÿè®¡
    }
    
    return dependencies[componentId] || []
  }
}
```

### 2. æ™ºèƒ½æ•°æ®èšåˆç³»ç»Ÿ

#### 2.1 å¤šæºæ•°æ®æ•´åˆ
```javascript
// å¤šæºæ•°æ®èšåˆå¼•æ“
class MultiSourceDataAggregator {
  constructor() {
    this.dataSources = new Map()
    this.aggregationRules = new Map()
    this.cacheManager = new CacheManager()
  }
  
  // æ³¨å†Œæ•°æ®æº
  registerDataSource(sourceId, dataSource) {
    this.dataSources.set(sourceId, {
      ...dataSource,
      lastUpdate: new Date(),
      status: 'active'
    })
  }
  
  // èšåˆå®ä¹ é‰´å®šæ•°æ®
  aggregateAppraisalData(studentId, rotationId, templateConfig) {
    const aggregatedData = {
      studentInfo: {},
      rotationInfo: {},
      evaluationData: {},
      metadata: {
        aggregationTime: new Date(),
        dataVersion: this.generateDataVersion()
      }
    }
    
    // èšåˆå„æ¨¡å—æ•°æ®
    for (const module of templateConfig.graduateModuleList) {
      const moduleData = this.aggregateModuleData(
        module.moduleCode,
        studentId,
        rotationId
      )
      
      aggregatedData.evaluationData[module.moduleCode] = {
        data: moduleData,
        weight: module.weight,
        score: this.calculateModuleScore(moduleData, module),
        lastUpdate: new Date()
      }
    }
    
    // è®¡ç®—ç»¼åˆè¯„åˆ†
    aggregatedData.overallScore = this.calculateOverallScore(
      aggregatedData.evaluationData,
      templateConfig
    )
    
    return aggregatedData
  }
  
  // èšåˆæ¨¡å—æ•°æ®
  aggregateModuleData(moduleCode, studentId, rotationId) {
    const cacheKey = `${moduleCode}_${studentId}_${rotationId}`
    const cachedData = this.cacheManager.get(cacheKey)
    
    if (cachedData && !this.isCacheExpired(cachedData)) {
      return cachedData.data
    }
    
    let moduleData = {}
    
    switch (moduleCode) {
      case 'EXAM_STATISTICS':
        moduleData = this.aggregateAttendanceData(studentId, rotationId)
        break
      case 'TEACHING_ACTIVTIES':
        moduleData = this.aggregateTeachingActivityData(studentId, rotationId)
        break
      case 'GRADUATION_EXAMINE':
        moduleData = this.aggregateExaminationData(studentId, rotationId)
        break
      case 'GRADUATION_EVALUATE':
        moduleData = this.aggregateEvaluationData(studentId, rotationId)
        break
      default:
        moduleData = this.aggregateGenericData(moduleCode, studentId, rotationId)
    }
    
    // ç¼“å­˜æ•°æ®
    this.cacheManager.set(cacheKey, {
      data: moduleData,
      timestamp: new Date(),
      ttl: 3600000 // 1å°æ—¶
    })
    
    return moduleData
  }
  
  // è®¡ç®—ç»¼åˆè¯„åˆ†
  calculateOverallScore(evaluationData, templateConfig) {
    let totalScore = 0
    let totalWeight = 0
    
    for (const module of templateConfig.graduateModuleList) {
      const moduleEvaluation = evaluationData[module.moduleCode]
      if (moduleEvaluation && moduleEvaluation.score !== null) {
        totalScore += moduleEvaluation.score * module.weight
        totalWeight += module.weight
      }
    }
    
    const overallScore = totalWeight > 0 ? totalScore / totalWeight : 0
    
    return {
      score: Math.round(overallScore * 100) / 100,
      level: this.getScoreLevel(overallScore),
      breakdown: this.generateScoreBreakdown(evaluationData),
      recommendations: this.generateRecommendations(evaluationData)
    }
  }
}
```

### 3. å®¡æ‰¹æµç¨‹å¼•æ“

#### 3.1 å¤šçº§å®¡æ‰¹ç³»ç»Ÿ
```javascript
// å®¡æ‰¹æµç¨‹å¼•æ“
class ApprovalWorkflowEngine {
  constructor() {
    this.workflowDefinitions = new Map()
    this.activeWorkflows = new Map()
    this.approvalHistory = new Map()
  }
  
  // å®šä¹‰å®¡æ‰¹æµç¨‹
  defineWorkflow(workflowId, definition) {
    this.workflowDefinitions.set(workflowId, {
      id: workflowId,
      name: definition.name,
      steps: definition.steps,
      rules: definition.rules,
      notifications: definition.notifications,
      timeouts: definition.timeouts
    })
  }
  
  // å¯åŠ¨å®¡æ‰¹æµç¨‹
  startApprovalWorkflow(appraisalId, workflowId, initiator) {
    const workflow = this.workflowDefinitions.get(workflowId)
    if (!workflow) {
      throw new Error(`æœªæ‰¾åˆ°å·¥ä½œæµå®šä¹‰: ${workflowId}`)
    }
    
    const workflowInstance = {
      id: this.generateWorkflowInstanceId(),
      appraisalId: appraisalId,
      workflowId: workflowId,
      initiator: initiator,
      currentStep: 0,
      status: 'RUNNING',
      startTime: new Date(),
      steps: workflow.steps.map(step => ({
        ...step,
        status: 'PENDING',
        assignee: this.resolveAssignee(step.assigneeRule, appraisalId),
        startTime: null,
        endTime: null,
        decision: null,
        comments: null
      }))
    }
    
    // æ¿€æ´»ç¬¬ä¸€æ­¥
    this.activateStep(workflowInstance, 0)
    
    this.activeWorkflows.set(workflowInstance.id, workflowInstance)
    
    return workflowInstance
  }
  
  // å¤„ç†å®¡æ‰¹å†³ç­–
  processApprovalDecision(workflowInstanceId, stepIndex, decision, comments, approver) {
    const workflow = this.activeWorkflows.get(workflowInstanceId)
    if (!workflow) {
      throw new Error(`æœªæ‰¾åˆ°å·¥ä½œæµå®ä¾‹: ${workflowInstanceId}`)
    }
    
    const step = workflow.steps[stepIndex]
    if (step.status !== 'ACTIVE') {
      throw new Error(`æ­¥éª¤${stepIndex}ä¸æ˜¯æ´»åŠ¨çŠ¶æ€`)
    }
    
    // è®°å½•å®¡æ‰¹å†³ç­–
    step.status = 'COMPLETED'
    step.endTime = new Date()
    step.decision = decision
    step.comments = comments
    step.approver = approver
    
    // è®°å½•å®¡æ‰¹å†å²
    this.recordApprovalHistory(workflowInstanceId, stepIndex, {
      decision: decision,
      comments: comments,
      approver: approver,
      timestamp: new Date()
    })
    
    // å¤„ç†å®¡æ‰¹ç»“æœ
    if (decision === 'APPROVE') {
      this.handleApprovalApproved(workflow, stepIndex)
    } else if (decision === 'REJECT') {
      this.handleApprovalRejected(workflow, stepIndex)
    } else if (decision === 'RETURN') {
      this.handleApprovalReturned(workflow, stepIndex)
    }
    
    return workflow
  }
  
  // å¤„ç†å®¡æ‰¹é€šè¿‡
  handleApprovalApproved(workflow, stepIndex) {
    const nextStepIndex = stepIndex + 1
    
    if (nextStepIndex < workflow.steps.length) {
      // æ¿€æ´»ä¸‹ä¸€æ­¥
      this.activateStep(workflow, nextStepIndex)
    } else {
      // å®¡æ‰¹æµç¨‹å®Œæˆ
      workflow.status = 'COMPLETED'
      workflow.endTime = new Date()
      
      // è§¦å‘å®Œæˆäº‹ä»¶
      this.triggerWorkflowCompleted(workflow)
    }
  }
  
  // å¤„ç†å®¡æ‰¹æ‹’ç»
  handleApprovalRejected(workflow, stepIndex) {
    workflow.status = 'REJECTED'
    workflow.endTime = new Date()
    
    // è§¦å‘æ‹’ç»äº‹ä»¶
    this.triggerWorkflowRejected(workflow, stepIndex)
  }
  
  // å¤„ç†å®¡æ‰¹é€€å›
  handleApprovalReturned(workflow, stepIndex) {
    workflow.status = 'RETURNED'
    workflow.endTime = new Date()
    
    // è§¦å‘é€€å›äº‹ä»¶
    this.triggerWorkflowReturned(workflow, stepIndex)
  }
}
```

---

## ğŸ“Š ä¸šåŠ¡ä»·å€¼åˆ†æ

### 1. æ•ˆç‡æå‡ä»·å€¼

#### 1.1 æµç¨‹è‡ªåŠ¨åŒ–æ•ˆæœ
```javascript
// æµç¨‹è‡ªåŠ¨åŒ–æ•ˆæœåˆ†æ
const processAutomationEffects = {
  before: {
    dataCollection: 'æ‰‹å·¥æ”¶é›†ï¼Œè€—æ—¶2-3å¤©',
    evaluation: 'äººå·¥è¯„ä¼°ï¼Œè€—æ—¶1-2å¤©',
    approval: 'çº¸è´¨å®¡æ‰¹ï¼Œè€—æ—¶1å‘¨',
    archiving: 'æ‰‹å·¥å½’æ¡£ï¼Œè€—æ—¶1å¤©',
    totalTime: '10-13å¤©'
  },
  
  after: {
    dataCollection: 'è‡ªåŠ¨é‡‡é›†ï¼Œè€—æ—¶10åˆ†é’Ÿ',
    evaluation: 'æ™ºèƒ½è¯„ä¼°ï¼Œè€—æ—¶30åˆ†é’Ÿ',
    approval: 'ç”µå­å®¡æ‰¹ï¼Œè€—æ—¶1-2å¤©',
    archiving: 'è‡ªåŠ¨å½’æ¡£ï¼Œè€—æ—¶1åˆ†é’Ÿ',
    totalTime: '1-2å¤©'
  },
  
  improvement: {
    timeReduction: '85%+æ—¶é—´èŠ‚çœ',
    accuracyIncrease: '95%+å‡†ç¡®ç‡æå‡',
    costReduction: '70%+æˆæœ¬é™ä½',
    satisfactionIncrease: '90%+æ»¡æ„åº¦æå‡'
  }
}
```

### 2. è´¨é‡ä¿è¯ä»·å€¼

#### 2.2 è¯„ä¼°æ ‡å‡†åŒ–
```javascript
// è¯„ä¼°æ ‡å‡†åŒ–ä»·å€¼
const evaluationStandardization = {
  consistency: {
    before: '60%ä¸€è‡´æ€§',
    after: '95%+ä¸€è‡´æ€§',
    improvement: '35%æå‡'
  },
  
  objectivity: {
    before: '70%å®¢è§‚æ€§',
    after: '90%+å®¢è§‚æ€§',
    improvement: '20%æå‡'
  },
  
  comprehensiveness: {
    before: '50%å…¨é¢æ€§',
    after: '100%å…¨é¢æ€§',
    improvement: '50%æå‡'
  }
}
```

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒåˆ›æ–°æˆå°±
1. **å¤šç»´åº¦è¯„ä¼°ä½“ç³»**: åˆ›å»ºäº†9ä¸ªä¸“ä¸šè¯„ä¼°ç»„ä»¶çš„å®Œæ•´ä½“ç³»
2. **åŠ¨æ€ç»„ä»¶åŠ è½½**: å®ç°äº†çµæ´»çš„ç»„ä»¶åŠ¨æ€åŠ è½½å’Œé…ç½®æœºåˆ¶
3. **æ™ºèƒ½æ•°æ®èšåˆ**: å»ºç«‹äº†å¤šæºæ•°æ®è‡ªåŠ¨èšåˆå’Œè®¡ç®—ç³»ç»Ÿ
4. **å®¡æ‰¹æµç¨‹å¼•æ“**: æ„å»ºäº†å®Œæ•´çš„å¤šçº§å®¡æ‰¹å·¥ä½œæµç³»ç»Ÿ
5. **æ¨¡æ¿é…ç½®ç³»ç»Ÿ**: å®ç°äº†çµæ´»çš„é‰´å®šæ¨¡æ¿é…ç½®å’Œç®¡ç†

### æŠ€æœ¯ä»·å€¼
1. **åˆ›æ–°æ€§**: åœ¨å®ä¹ é‰´å®šç®¡ç†é¢†åŸŸå®ç°äº†é‡å¤§æŠ€æœ¯çªç ´
2. **å®ç”¨æ€§**: è§£å†³äº†å®ä¹ ç®¡ç†çš„æ ¸å¿ƒä¸šåŠ¡ç—›ç‚¹
3. **æ‰©å±•æ€§**: æ”¯æŒä¸åŒç§‘å®¤å’Œä¸“ä¸šçš„çµæ´»é…ç½®
4. **æ ‡å‡†æ€§**: å»ºç«‹äº†å®ä¹ é‰´å®šç®¡ç†çš„æŠ€æœ¯æ ‡å‡†

### å•†ä¸šä»·å€¼
1. **æ•ˆç‡æå‡**: æµç¨‹æ•ˆç‡æå‡85%+
2. **è´¨é‡æ”¹å–„**: è¯„ä¼°è´¨é‡æå‡35%+
3. **æˆæœ¬èŠ‚çº¦**: ç®¡ç†æˆæœ¬é™ä½70%+
4. **ç”¨æˆ·æ»¡æ„**: ç”¨æˆ·æ»¡æ„åº¦æå‡90%+

**è®¸è¾‰çš„å®ä¹ é‰´å®šç®¡ç†æ¨¡å—æ˜¯åŒ»é™¢å®ä¹ ç®¡ç†æ•°å­—åŒ–è½¬å‹çš„é‡å¤§æŠ€æœ¯çªç ´ï¼Œä¸ºåŒ»é™¢æ•™è‚²ç®¡ç†æä¾›äº†å®Œæ•´çš„å®ä¹ é‰´å®šè§£å†³æ–¹æ¡ˆï¼** ğŸ”¥ğŸš€
