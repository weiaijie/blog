# 股票筛选系统

## 系统目标

通过量化指标筛选出具有投资价值的股票，建立高质量的股票池。

## 筛选指标

### 1. 估值指标

#### PE（市盈率）
- **标准**：PE < 15 或 行业PE百分位 < 30%
- **说明**：选择相对便宜的股票
- **数据源**：理杏仁、萝卜投研、同花顺

#### PB（市净率）
- **标准**：PB < 2 或 PB十年百分位 < 20%
- **说明**：避免高估值陷阱
- **特殊情况**：银行股PB < 0.8，地产股PB < 1.2

#### PB十年百分位
- **标准**：< 20%
- **说明**：当前PB在历史十年中的位置
- **优势**：消除行业差异，更准确反映估值水平

### 2. 盈利指标

#### ROE（净资产收益率）
- **标准**：ROE > 10%
- **说明**：公司盈利能力的核心指标
- **计算**：使用TTM数据，避免季节性波动

#### ROA（总资产收益率）
- **标准**：ROA > 5%
- **说明**：资产使用效率指标
- **适用**：重资产行业重点关注

### 3. 财务健康指标

#### 负债率
- **标准**：负债率 < 60%
- **说明**：控制财务风险
- **例外**：银行、保险等金融股除外

#### 流动比率
- **标准**：流动比率 > 1.2
- **说明**：短期偿债能力
- **重点**：制造业、零售业等

### 4. 分红指标

#### 股息率
- **标准**：股息率 > 3%
- **说明**：提供稳定现金流
- **计算**：基于过去12个月分红

#### 分红连续性
- **标准**：连续分红 > 3年
- **说明**：分红政策稳定性
- **加分项**：分红逐年增长

### 5. 规模指标

#### 市值
- **标准**：市值 > 100亿
- **说明**：避免小盘股风险
- **例外**：特殊行业龙头可适当放宽

#### 流通市值
- **标准**：流通市值 > 50亿
- **说明**：保证流动性
- **重要性**：影响买卖便利性

## 筛选流程

### 第一步：基础筛选
```
1. 剔除ST、*ST股票
2. 剔除上市不足2年的新股
3. 剔除市值小于100亿的股票
4. 剔除负债率超过80%的股票（金融股除外）
```

### 第二步：财务筛选
```
1. ROE > 10%
2. 负债率 < 60%
3. 流动比率 > 1.2
4. 连续盈利 > 3年
```

### 第三步：估值筛选
```
1. PE < 15 或 行业PE百分位 < 30%
2. PB < 2 或 PB十年百分位 < 20%
3. 股息率 > 3%
```

### 第四步：行业筛选
```
1. 避开强周期行业（钢铁、煤炭、有色等）
2. 重点关注消费、医药、科技、金融
3. 每个行业最多选择3-5只股票
```

## 数据获取

### 自动获取方式

#### 腾讯文档
```
=STOCKPRICE("000001.SZ")  # 获取股价
=STOCKINFO("000001.SZ","pe")  # 获取PE
=STOCKINFO("000001.SZ","pb")  # 获取PB
```

#### Excel插件
- Wind插件：专业但收费
- 同花顺插件：免费但功能有限
- 东方财富插件：中等功能

### 手动获取方式

#### 理杏仁网站
1. 注册账号（免费版够用）
2. 选择"选股器"功能
3. 设置筛选条件
4. 导出Excel文件

#### 萝卜投研
1. 访问萝卜投研网站
2. 使用"财务指标"筛选
3. 批量导出数据

## Excel表格设计

### 主要列名
| 列名 | 说明 | 数据源 | 更新频率 |
|------|------|--------|----------|
| 股票代码 | 6位数字代码 | 手动输入 | 一次性 |
| 股票名称 | 中文名称 | 自动获取 | 实时 |
| 当前价格 | 最新股价 | 自动获取 | 实时 |
| PE | 市盈率TTM | 自动获取 | 日更新 |
| PB | 市净率 | 自动获取 | 日更新 |
| ROE | 净资产收益率 | 季度更新 | 季报后 |
| 股息率 | 年化股息率 | 年度更新 | 分红后 |
| 市值 | 总市值 | 自动计算 | 实时 |
| 行业 | 申万行业分类 | 手动输入 | 一次性 |

### 筛选公式示例
```excel
=AND(D2<15, E2<2, F2>10, G2>3, H2>100)
```

## 更新频率

- **每月第一个周末**：全面更新筛选条件
- **每周**：检查新增符合条件的股票
- **每日**：更新价格数据
- **季报后**：更新财务数据

## 注意事项

1. **避免数据滞后**：财务数据有1-2个月滞后
2. **关注行业轮动**：适时调整行业权重
3. **定期回测**：验证筛选条件有效性
4. **保持客观**：不因个人偏好改变标准

## 常见问题

**Q：为什么要设置市值门槛？**
A：小盘股流动性差，容易被操纵，风险较大。

**Q：如何处理亏损股？**
A：直接剔除，不考虑扭亏为盈的可能性。

**Q：银行股如何特殊处理？**
A：银行股负债率高是正常的，重点看资本充足率。

**Q：如何避免价值陷阱？**
A：结合ROE、现金流等指标，不仅看估值。
